<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>the debate room | v3.0</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root { --bg: #0d0d0f; --surface: #16161a; --border: #2a2a30; --text: #e8e8f0; --muted: #666678; --accent: #e8ff47; --stop: #ff4444; }

  body { background: var(--bg); color: var(--text); font-family: 'IBM Plex Mono', monospace; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
  
  header { padding: 15px 25px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; background: #0a0a0c; }
  header h1 { font-family: 'Syne'; font-weight: 800; font-size: 1.1rem; color: var(--accent); }

  .topic-bar { padding: 15px 25px; border-bottom: 1px solid var(--border); display: flex; gap: 10px; background: var(--surface); align-items: center; z-index: 10; }
  .mode-select, .round-select { background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 8px; font-size: 0.75rem; cursor: pointer; }
  .topic-bar input { flex: 1; background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 8px 12px; outline: none; }
  .topic-bar button { background: var(--accent); color: #000; border: none; font-weight: 700; padding: 8px 15px; cursor: pointer; font-family: 'Syne'; }

  .main-container { display: flex; flex: 1; overflow: hidden; }
  .editor-sidebar { width: 320px; border-right: 1px solid var(--border); padding: 20px; overflow-y: auto; background: #0a0a0c; }
  .persona-card { background: var(--surface); border: 1px solid var(--border); padding: 15px; margin-bottom: 12px; }
  .persona-card label { font-size: 0.65rem; color: var(--accent); display: block; margin-bottom: 8px; font-weight: 700; text-transform: uppercase; }
  .persona-card textarea { width: 100%; background: var(--bg); border: 1px solid var(--border); color: #ccc; font-size: 0.75rem; padding: 8px; height: 70px; outline: none; resize: none; line-height: 1.4; }

  .chat-area { flex: 1; overflow-y: auto; padding: 30px; display: flex; flex-direction: column; scroll-behavior: smooth; }
  .msg { display: flex; gap: 20px; padding: 25px 0; border-bottom: 1px solid #1c1c22; animation: fade 0.4s ease-out; }
  @keyframes fade { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  
  .avatar { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-weight: 800; border: 1px solid; flex-shrink: 0; font-size: 0.8rem; }
  .msg-name { font-family: 'Syne'; font-weight: 700; font-size: 0.85rem; margin-bottom: 6px; display: block; letter-spacing: 0.05em; }
  .msg-text { font-size: 0.9rem; line-height: 1.7; color: #ddd; }

  .typing-indicator { font-size: 0.7rem; color: var(--accent); margin: 15px 0; font-style: italic; display: none; border-left: 2px solid var(--accent); padding-left: 10px; }
  .round-divider { text-align: center; font-size: 0.65rem; color: var(--muted); padding: 30px 0; text-transform: uppercase; letter-spacing: 0.3em; border-top: 1px solid #1c1c22; margin-top: 20px; }
</style>
</head>
<body>

<header>
  <div style="display: flex; align-items: center; gap: 15px;">
    <a href="index.html" style="font-size: 0.6rem; color: var(--muted); text-decoration: none; border: 1px solid var(--border); padding: 4px 10px;">‚Üê HUB</a>
    <h1>the debate room</h1>
  </div>
  <div id="vibe-display" style="font-size: 0.65rem; font-weight: 700; color: #44ff44;">VIBE: ANALYTICAL</div>
</header>

<div class="topic-bar">
  <select id="rounds" class="round-select">
    <option value="3">3 ROUNDS</option>
    <option value="5">5 ROUNDS</option>
    <option value="10">10 ROUNDS</option>
  </select>
  <input type="text" id="topic" placeholder="What shall we debate?" />
  <button id="start-btn" onclick="runDebate()">START DEBATE</button>
  <button id="stop-btn" onclick="halt()" style="background:var(--stop); color:white; display:none;">STOP</button>
</div>

<div class="main-container">
  <div class="editor-sidebar" id="sidebar">
    <div id="persona-fields"></div>
  </div>
  <div class="chat-area" id="box">
    <div id="typing-status" class="typing-indicator"></div>
  </div>
</div>

<script>
const KEY = "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"; 

const BOTS = [
  { n: "GROK", c: "#ff3c3c", default: "Skeptical, slightly edgy, values raw data over feelings. Critical of other models." },
  { n: "CLAUDE", c: "#a78bfa", default: "Nuanced, highly ethical, focuses on long-term consequences. Very articulate." },
  { n: "CHATGPT", c: "#f5c842", default: "Balanced, diplomatic, uses structured reasoning. Plays the 'middle ground'." },
  { n: "GEMINI", c: "#4affda", default: "Creative, optimistic, looks for unconventional angles. Uses broad analogies." },
  { n: "DEEPSEEK", c: "#5cffa8", default: "Blunt, efficient, ignores social niceties. Purely focused on logical consistency." }
];

let active = false, stop = false, history = [];

function setup() {
  document.getElementById("persona-fields").innerHTML = BOTS.map((b, i) => `
    <div class="persona-card">
      <label>${b.n} LOGIC ENGINE</label>
      <textarea id="p-${i}">${b.default}</textarea>
    </div>`).join('');
}

function getSystemPrompt(idx, topic) {
  const behavior = document.getElementById(`p-${idx}`).value;
  const name = BOTS[idx].n;
  const others = BOTS.filter(b => b.n !== name).map(b => b.n).join(", ");

  return `You are the ${name} AI model participating in a professional debate.
  TOPIC: "${topic}"
  PERSONALITY: ${behavior}
  
  RULES:
  1. Address other participants ONLY by their model names: ${others}.
  2. DO NOT invent human names (like Alex or Julian). 
  3. Speak like a sophisticated AI, not a chatbot. No "LMAO", "???", or slang (unless youre GROK).
  4. Be competitive. Challenge the logic of the other models directly.
  5. Keep responses to 3 sentences maximum.`;
}

async function runDebate() {
  if (active) return;
  const topic = document.getElementById("topic").value.trim();
  const maxRounds = parseInt(document.getElementById("rounds").value);
  if (!topic) return;

  active = true; stop = false; history = [];
  document.getElementById("start-btn").disabled = true;
  document.getElementById("stop-btn").style.display = "block";
  document.getElementById("box").innerHTML = '<div id="typing-status" class="typing-indicator"></div>';

  for (let r = 1; r <= maxRounds; r++) {
    if (stop) break;
    document.getElementById("box").insertAdjacentHTML("beforeend", `<div class="round-divider">ROUND ${r}</div>`);
    
    // Shuffle order each round
    let order = [0,1,2,3,4].sort(() => 0.5 - Math.random());
    
    for (let i of order) {
      if (stop) break;
      const name = BOTS[i].n;
      const typing = document.getElementById("typing-status");
      
      typing.innerText = `${name} is analyzing the thread...`;
      typing.style.display = "block";
      document.getElementById("box").appendChild(typing);
      document.getElementById("box").scrollTop = 99999;

      await new Promise(res => setTimeout(res, 1500));

      try {
        const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
          method: "POST",
          headers: { "Content-Type": "application/json", "Authorization": `Bearer ${KEY}` },
          body: JSON.stringify({
            model: "llama-3.3-70b-versatile",
            messages: [
              {role: "system", content: getSystemPrompt(i, topic)},
              {role: "user", content: `Current Debate History:\n${history.slice(-6).join("\n")}\n\nYour turn to respond to the topic or a specific model.`}
            ],
            temperature: 0.8
          })
        });
        
        const d = await res.json();
        const msg = d.choices[0].message.content;
        
        typing.style.display = "none";
        history.push(`${name}: ${msg}`);
        
        document.getElementById("box").insertAdjacentHTML("beforeend", `
          <div class="msg">
            <div class="avatar" style="border-color:${BOTS[i].c};color:${BOTS[i].c}">${name[0]}</div>
            <div>
              <span class="msg-name" style="color:${BOTS[i].c}">${name}</span>
              <div class="msg-text">${msg}</div>
            </div>
          </div>`);
        document.getElementById("box").scrollTop = 99999;
      } catch (e) { console.error(e); }
    }
  }
  
  active = false;
  document.getElementById("start-btn").disabled = false;
  document.getElementById("stop-btn").style.display = "none";
}

function halt() { stop = true; }
setup();
</script>
</body>
</html>
