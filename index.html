<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>the debate room</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root { --bg: #0d0d0f; --surface: #16161a; --border: #2a2a30; --text: #e8e8f0; --muted: #666678; --accent: #e8ff47; --stop: #ff4444; }

  body { background: var(--bg); color: var(--text); font-family: 'IBM Plex Mono', monospace; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
  
  /* SQUARE EVERYTHING */
  input, select, button, .avatar, .persona-card { border-radius: 0px !important; }

  header { padding: 15px 25px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
  header h1 { font-family: 'Syne'; font-weight: 800; font-size: 1.1rem; color: var(--accent); }

  .topic-bar { padding: 15px 25px; border-bottom: 1px solid var(--border); display: flex; gap: 8px; background: var(--surface); align-items: center; }
  .mode-select { background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 8px; font-size: 0.75rem; cursor: pointer; }
  .topic-bar input { flex: 1; background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 8px 12px; outline: none; }
  .topic-bar button { background: var(--accent); color: #000; border: none; font-weight: 700; padding: 8px 15px; cursor: pointer; font-family: 'Syne'; }
  #gen-topic-btn { background: var(--border); color: var(--text); font-size: 0.7rem; }
  #stop-btn { background: var(--stop); color: #fff; display: none; }

  /* Persona Editor Sidebar */
  .main-container { display: flex; flex: 1; overflow: hidden; }
  .editor-sidebar { width: 280px; border-right: 1px solid var(--border); padding: 20px; overflow-y: auto; background: #0a0a0c; }
  .editor-sidebar h3 { font-size: 0.7rem; color: var(--muted); text-transform: uppercase; margin-bottom: 15px; letter-spacing: 0.1em; }
  .persona-card { background: var(--surface); border: 1px solid var(--border); padding: 12px; margin-bottom: 12px; }
  .persona-card label { font-size: 0.65rem; color: var(--accent); display: block; margin-bottom: 5px; font-weight: 700; }
  .persona-card textarea { width: 100%; background: var(--bg); border: 1px solid var(--border); color: #ccc; font-size: 0.7rem; padding: 5px; resize: none; font-family: inherit; height: 50px; outline: none; }

  .chat-area { flex: 1; overflow-y: auto; padding: 25px; display: flex; flex-direction: column; }
  .msg { display: flex; gap: 15px; padding: 20px 0; border-bottom: 1px solid #1c1c22; animation: fade 0.3s ease; }
  @keyframes fade { from { opacity: 0; } to { opacity: 1; } }
  .avatar { width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; font-weight: 800; border: 1px solid; flex-shrink: 0; font-size: 0.75rem; }
  .msg-name { font-family: 'Syne'; font-weight: 700; font-size: 0.8rem; margin-bottom: 4px; display: block; }
  .msg-text { font-size: 0.82rem; line-height: 1.6; color: #ccc; }
  .label { text-align: center; font-size: 0.6rem; color: var(--muted); padding: 20px 0; text-transform: uppercase; letter-spacing: 0.2em; }
</style>
</head>
<body>

<header>
  <h1>the debate room</h1>
  <button id="refresh-names" onclick="setupBots()" style="background:none; border:none; color:var(--muted); font-size:0.6rem; cursor:pointer;">[REFRESH CAST]</button>
</header>

<div class="topic-bar">
  <select id="mode" class="mode-select" onchange="toggleEditor()">
    <option value="chaos">Chaos Mode</option>
    <option value="mimic">AI Mimicry</option>
  </select>
  <button id="gen-topic-btn" onclick="generateTopic()">Generate Topic</button>
  <input type="text" id="topic" placeholder="What's the beef?" />
  <button id="start-btn" onclick="run()">Start</button>
  <button id="stop-btn" onclick="halt()">Stop</button>
</div>

<div class="main-container">
  <div class="editor-sidebar" id="sidebar">
    <h3>Persona Editor (Chaos)</h3>
    <div id="persona-fields"></div>
  </div>
  <div class="chat-area" id="box"></div>
</div>

<script>
const KEY = "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";

const OLD_NAMES = ["KAEL", "ZYLA", "BARD", "GLORP", "SOLEN"];
const NAME_POOL = ["XENON", "NEO", "VORTEX", "BYT3", "CYRUS", "AURA", "RAVEN", "ORBIT", "FLUX", "ZODIAC", "NOVA", "QUBIT", "GHOST", "PULSE", "ZENITH", "AETHER", "VECTOR", "ONYX", "AXIOM", "VOID", "DATA", "COBALT", "TITAN", "SOLAR", "CYBER", "OMEGA", "ALPHA", "CHRONOS", "KINETIC", "NEBULA"];
const TOPICS = ["Is water wet?", "Cereal is soup: Yes or No?", "Pineapple on pizza is a crime.", "AI will replace all artists by 2030.", "Hot dogs are sandwiches.", "The moon landing was a movie set.", "Cats are better than dogs.", "Should we ban TikTok?", "Is cereal a soup?", "Batman could beat Superman with no prep time.", "Are these topics AI generated?"];

let active = false, stop = false, history = [], bots = [];

// Default Chaos behaviors
let behaviors = [
  "Extremely aggressive, defensive, and hates everyone's opinion.",
  "Write entirely in gen z internet slang. lowercase only, barely any punctuation, and relatively stupid. Use: lowkirkenuinely, genuinely, mi bomboclat, lebron james hairline, bussin, lowkey, highkey, rent free, sonðŸ˜­ðŸ˜­, ðŸ˜‚ðŸ«±, boii, gtfo, mid, based, NPC, lmao, sybau, yo, syfm, imo, smh, dih, etc. You make decent points but they're buried in slang. 1-2 short sentences.",
  "Shakespearean English only. Thee, thou, forsooth, and dramatic flair.",
  "Confidently talks about random unrelated things like cheese or space.",
  "An exhausted, grumpy realist who thinks everyone else is a moron."
];

function setupBots() {
  const pool = [...NAME_POOL].sort(() => 0.5 - Math.random());
  // Use Old Names first, then fill with pool
  bots = OLD_NAMES.concat(pool).slice(0, 5).map((n, i) => ({
    n, 
    c: ["#ff3c3c","#a78bfa","#f5c842","#4affda","#5cffa8"][i],
    behavior: behaviors[i]
  }));
  renderEditor();
}

function renderEditor() {
  const container = document.getElementById("persona-fields");
  container.innerHTML = bots.map((b, i) => `
    <div class="persona-card">
      <label>${b.n}</label>
      <textarea onchange="updateBehavior(${i}, this.value)">${b.behavior}</textarea>
    </div>
  `).join('');
}

function updateBehavior(i, val) { bots[i].behavior = val; }
function toggleEditor() { document.getElementById("sidebar").style.opacity = document.getElementById("mode").value === 'mimic' ? '0.3' : '1'; }
function generateTopic() { document.getElementById("topic").value = TOPICS[Math.floor(Math.random() * TOPICS.length)]; }

function getSystem(idx, mode) {
  const b = bots[idx];
  if (mode === 'mimic') {
    const targets = [
      { t: "GROK", s: "Be aggressive, edgy, use dark humor, and act like a rebellious anti-establishment AI. NO FILTER." },
      { t: "CLAUDE", s: "Be extremely polite, formal, intellectual, and cautious. Use complex academic language." },
      { t: "CHATGPT", s: "Be helpful, balanced, neutral, and use structured bullet points if possible. Professional tone." },
      { t: "GEMINI", s: "Be highly collaborative, friendly, creative, and mention multi-modal capabilities. Upbeat tone." },
      { t: "DEEPSEEK", s: "Be blunt, technical, extremely logical, and provide deep-reasoning steps. Efficient and cold." }
    ];
    return `You are ${b.n}. You MUST perfectly mimic ${targets[idx].t}. Instruction: ${targets[idx].s} Debate the topic fiercely.`;
  }
  return `You are ${b.n}. Style: ${b.behavior} Keep it short.`;
}

async function run() {
  if (active) return;
  const t = document.getElementById("topic").value.trim();
  if (!t) return;
  active = true; stop = false; history = [];
  document.getElementById("start-btn").disabled = true;
  document.getElementById("stop-btn").style.display = "block";
  document.getElementById("box").innerHTML = "";
  
  for (let r = 1; r <= 3; r++) {
    if (stop) break;
    const l = document.createElement("div"); l.className = "label"; l.innerText = `ROUND ${r}`; document.getElementById("box").appendChild(l);
    let order = [0,1,2,3,4].sort(() => 0.5 - Math.random());
    for (let i of order) {
      if (stop) break;
      const bot = bots[i];
      try {
        const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
          method: "POST",
          headers: { "Content-Type": "application/json", "Authorization": `Bearer ${KEY}` },
          body: JSON.stringify({
            model: "llama-3.3-70b-versatile",
            messages: [{role:"system", content: getSystem(i, document.getElementById("mode").value)}, {role:"user", content: `Topic: ${t}\n\nPrevious: ${history.slice(-4).join(" | ")}`}]
          })
        });
        const d = await res.json();
        const msg = d.choices[0].message.content;
        history.push(`${bot.n}: ${msg}`);
        document.getElementById("box").insertAdjacentHTML("beforeend", `<div class="msg"><div class="avatar" style="border-color:${bot.c};color:${bot.c}">${bot.n[0]}</div><div class="msg-body"><span class="msg-name" style="color:${bot.c}">${bot.n}</span><div class="msg-text">${msg}</div></div></div>`);
        document.getElementById("box").scrollTop = 99999;
      } catch (e) { console.error(e); }
      await new Promise(r => setTimeout(r, 1200));
    }
  }
  active = false; document.getElementById("start-btn").disabled = false; document.getElementById("stop-btn").style.display = "none";
}

function halt() { stop = true; }
setupBots();
</script>
</body>
</html>
